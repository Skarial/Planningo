<!doctype html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no"
    />

    <title>Planning chauffeur</title>
    <meta
      name="description"
      content="Gestion du planning de service pour chauffeurs"
    />

    <!-- PWA -->
    <meta name="theme-color" content="#0066ff" />
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="default" />

    <link rel="manifest" href="./manifest.webmanifest" />

    <!-- iOS icon -->
    <link rel="apple-touch-icon" href="./assets/icons/icon-192.png" />

    <!-- Favicon -->
    <link rel="icon" href="./assets/icons/icon-192.png" />

    <!-- Styles -->
    <link rel="stylesheet" href="./css/style.css" />
    <link rel="stylesheet" href="./css/tetribus.css" />
  </head>

  <body>
    <!-- APP ROOT : CONTENEUR FLEX GLOBAL -->
    <div id="app-root">
      <!-- BOUTON MENU (HORS FLUX) -->
      <button id="menu-toggle" aria-label="Menu">☰</button>
      <div id="menu-overlay"></div>

      <!-- MENU LATÉRAL (HORS FLUX) -->
      <nav id="side-menu" aria-hidden="true">
        <div id="side-menu-scroll">
          <div class="menu-title">Menu</div>

          <div class="menu-section">
            <h3>Navigation</h3>

            <button data-action="home">
              <span class="menu-icon icon-day"></span>
              Accueil
            </button>

            <button data-action="guided-month">
              <span class="menu-icon icon-guided"></span>
              Saisie du planning
            </button>

            <button data-action="tetribus">
              <span class="menu-icon icon-game"></span>
              Tetribus
            </button>
          </div>

          <div class="menu-section">
            <h3>Outils</h3>

            <button id="menu-consult-date">
              <span class="menu-icon icon-consult"></span>
              Consulter une date
            </button>

            <div id="consult-date-form" class="menu-form hidden">
              <label for="consult-date-input">Date</label>
              <input type="date" id="consult-date-input" />
              <button id="consult-date-submit">Valider</button>
            </div>

            <button id="menu-conges">
              <span class="menu-icon icon-conges"></span>
              Congés
            </button>

            <button id="menu-season">
              <span class="menu-icon icon-season"></span>
              Période saisonnière
            </button>

            <button id="menu-phone-change">
              <span class="menu-icon icon-phone"></span>
              Changement de téléphone
            </button>
          </div>

          <div class="menu-section">
            <h3>Paramètres</h3>

            <button id="menu-reset" class="danger">
              <span class="menu-icon icon-reset"></span>
              Réinitialisation
            </button>

            <div id="reset-panel" class="menu-form hidden">
              <p class="reset-title">Réinitialisation du planning</p>

              <button
                id="reset-all"
                class="danger menu-long-press"
                type="button"
              >
                Maintenir pour tout réinitialiser
              </button>

              <button id="reset-month">Réinitialiser un mois</button>

              <div id="reset-month-picker" class="hidden">
                <div class="reset-month-nav">
                  <button
                    id="reset-prev-month"
                    class="today-arrow arrow-left"
                  ></button>
                  <span id="reset-month-label"></span>
                  <button
                    id="reset-next-month"
                    class="today-arrow arrow-right"
                  ></button>
                </div>

                <button id="reset-confirm-month" class="danger menu-long-press">
                  Maintenir pour réinitialiser le mois
                </button>
              </div>
            </div>
          </div>

          <div id="menu-footer">
            <span id="app-version"></span>
          </div>
        </div>
      </nav>

      <!-- CONTENU PRINCIPAL (SEUL FLUX FLEX) -->
      <main id="app-main">
        <section id="view-home"></section>
        <section id="view-guided-month" hidden></section>
        <section id="view-conges" hidden></section>
        <section id="view-season" hidden></section>
        <section id="view-phone-change" hidden></section>
        <section id="view-tetribus" hidden></section>
      </main>
    </div>

    <!-- APP -->
    <script type="module" src="./js/app.js"></script>

    <script>
      document.addEventListener("contextmenu", function (e) {
        if (
          e.target.closest(".menu-long-press") ||
          e.target.closest("#view-tetribus")
        ) {
          e.preventDefault();
        }
      });
    </script>
  </body>
</html>
